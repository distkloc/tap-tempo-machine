"use strict";angular.module("tapTempoMachineApp",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch","rx"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("tapTempoMachineApp").controller("MainCtrl",["$scope","tapTempo",function(a,b){a.bpm=0,a.$on("tapTempo.update",function(){b.bpmSource().safeApply(a,function(b){a.bpm=b}).subscribe()})}]),function(){function a(a,c,d){return function(e,f){var g=a.Observable.fromEvent(f,"click");c.add(g),b(e,g,d)}}function b(a,b,c){b.safeApply(a,function(){a.clicked="clicked",c(function(){a.clicked=""},50)}).subscribe()}angular.module("tapTempoMachineApp").directive("clickCollector",a),a.$inject=["rx","tapTempo","$timeout"]}(),function(){function a(a,c){return function(d,e){var f=e.keydownAsObservable().where(function(a){return 74===a.keyCode});a.add(f),b(d,f,c)}}function b(a,b,c){b.safeApply(a,function(){a.downed="downed",c(function(){a.downed=""},50)}).subscribe()}angular.module("tapTempoMachineApp").directive("keydownCollector",a),a.$inject=["tapTempo","$timeout"]}(),angular.module("tapTempoMachineApp").factory("tapTempo",["rx","$rootScope",function(a,b){var c=[];return{add:function(a){c.push(a),b.$broadcast("tapTempo.update")},bpmSource:function(){var b=a.Observable.merge(c).timeInterval().skip(1).pluck("interval").where(function(a){return 1e4>=a});return b.windowWithCount(8,1).merge(b.windowWithCount(4,1).take(7)).selectMany(function(a){return a.average()}).map(function(a){return Math.round(6e4/a)})}}}]);