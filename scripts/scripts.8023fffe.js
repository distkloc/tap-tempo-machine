"use strict";angular.module("tapTempoMachineApp",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch","rx"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("tapTempoMachineApp").controller("MainCtrl",["$scope","tapTempo",function(a,b){a.bpm=0,b.add("click",a.$createObservableFunction("collectClick")),a.$on("tapTempo.update",function(){b.bpmSource().safeApply(a,function(b){a.bpm=b}).subscribe()})}]),function(){function a(a,b){return{compile:function(){return{pre:function(){var c=b.keydownAsObservable().where(function(a){return 74===a.keyCode});a.add("keydown",c)}}}}}angular.module("tapTempoMachineApp").directive("keydownCollector",a),a.$inject=["tapTempo","$document"]}(),function(){function a(a,b){return function(c,d,e){var f=b.getSourceBy(e.lightning);f&&f.safeApply(c,function(){c.targetSource=e.lightning,a(function(){c.targetSource=""},50)}).subscribe()}}angular.module("tapTempoMachineApp").directive("lightning",a),a.$inject=["$timeout","tapTempo"]}(),angular.module("tapTempoMachineApp").factory("tapTempo",["rx","$rootScope",function(a,b){var c=[];return{add:function(a,d){var e={};e.name=a,e.observable=d,c.push(e),b.$broadcast("tapTempo.update")},getSourceBy:function(a){return c.filter(function(b){return b.name===a}).map(function(a){return a.observable})[0]},bpmSource:function(){var b=c.map(function(a){return a.observable}),d=a.Observable.merge(b).timeInterval().skip(1).pluck("interval").where(function(a){return 1e4>=a});return d.windowWithCount(8,1).merge(d.windowWithCount(4,1).take(7)).selectMany(function(a){return a.average()}).map(function(a){return Math.round(6e4/a)})}}}]);