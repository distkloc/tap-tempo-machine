"use strict";angular.module("tapTempoMachineApp",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch","rx"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("tapTempoMachineApp").controller("MainCtrl",["$scope","$timeout","tapTempo",function(a,b,c){a.bpm=0,a.$on("tap",function(){a.$apply(function(){a.flash="flash",a.bgFlash="bg-flash",b(function(){a.flash="",a.bgFlash=""},50)})});var d=a.$eventToObservable("tap");c.add(d),c.bpmSource().safeApply(a,function(b){a.bpm=b}).subscribe()}]),angular.module("tapTempoMachineApp").directive("tapTempo",["$rootScope",function(a){return function(b,c){var d="keydown",e="click",f=function(){a.$broadcast("tap")};c.on(d,function(a){74===a.keyCode&&f()}),c.on(e,function(){f()}),b.$on("$destroy",function(){c.off(d),c.off(e)})}}]),angular.module("tapTempoMachineApp").factory("tapTempo",["rx",function(a){var b=[];return{add:function(a){b.push(a)},bpmSource:function(){var c=a.Observable.merge(b).timeInterval().skip(1).pluck("interval").where(function(a){return 1e4>=a});return c.windowWithCount(8,1).merge(c.windowWithCount(4,1).take(7)).selectMany(function(a){return a.average()}).map(function(a){return Math.round(6e4/a)})}}}]);